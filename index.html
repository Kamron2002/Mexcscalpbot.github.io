<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Saraf Ultimate Control</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #0d1117; --card: #161b22; --text: #e6edf3;
            --sub: #8b949e; --green: #238636; --red: #da3633; --blue: #1f6feb;
            --orange: #d29922;
        }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; padding: 16px; padding-bottom: 80px; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .badge { background: rgba(35,134,54,0.2); color: #3fb950; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; }
        
        /* –ö–ê–†–¢–û–ß–ö–ò */
        .card { background: var(--card); border: 1px solid #30363d; border-radius: 16px; padding: 16px; margin-bottom: 12px; }
        h3 { margin: 0 0 12px 0; font-size: 14px; color: var(--sub); text-transform: uppercase; display: flex; align-items: center; gap: 8px; }
        
        /* –°–ï–¢–ö–ê */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .input-box label { display: block; font-size: 10px; color: var(--sub); margin-bottom: 4px; }
        input { width: 100%; background: #0d1117; border: 1px solid #30363d; color: white; padding: 10px; border-radius: 8px; font-size: 14px; box-sizing: border-box; }
        input:focus { border-color: var(--blue); outline: none; }

        /* TOGGLES */
        .toggle { display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.03); padding: 10px; border-radius: 8px; margin-bottom: 8px; }
        .toggle span { font-size: 13px; }

        /* –ö–ù–û–ü–ö–ò */
        .btn-row { display: flex; gap: 10px; margin-top: 10px; }
        button { flex: 1; padding: 14px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; color: white; font-size: 14px; }
        .btn-save { background: var(--green); box-shadow: 0 4px 12px rgba(35,134,54,0.3); }
        .btn-stop { background: var(--card); border: 1px solid var(--red); color: var(--red); }
        .btn-add { background: var(--blue); }
        .btn-stats { background: var(--orange); color: black; }

        /* FOOTER */
        .footer { text-align: center; font-size: 10px; color: var(--sub); margin-top: 20px; }
    </style>
</head>
<body>

    <div class="header">
        <div>
            <div style="font-size: 18px; font-weight: 800;">SARAF V43</div>
            <div style="font-size: 11px; color: var(--sub);">Ultimate Terminal</div>
        </div>
        <div class="badge">ONLINE</div>
    </div>

    <div class="card">
        <h3>‚ö° –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
        <div class="input-box" style="margin-bottom: 10px;">
            <label>–¢–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞</label>
            <input type="text" id="symbol" value="ETH/USDC" style="color: var(--blue); font-weight: bold;">
        </div>
        <div class="grid">
            <div class="input-box"><label>–õ–æ—Ç ($)</label><input type="number" id="amount" value="10"></div>
            <div class="input-box"><label>Martingale (x)</label><input type="number" id="mart" value="1.5"></div>
            <div class="input-box"><label>Drop %</label><input type="number" id="drop" value="0.35"></div>
            <div class="input-box"><label>Take Profit %</label><input type="number" id="tp" value="0.5"></div>
        </div>
    </div>

    <div class="card">
        <h3>üìè –î–∏–∞–ø–∞–∑–æ–Ω –∏ –ó–∞—â–∏—Ç–∞</h3>
        <div class="grid">
            <div class="input-box"><label>Min –¶–µ–Ω–∞ (0=–í—ã–∫–ª)</label><input type="number" id="min_p" value="0"></div>
            <div class="input-box"><label>Max –¶–µ–Ω–∞ (0=–í—ã–∫–ª)</label><input type="number" id="max_p" value="0"></div>
            <div class="input-box"><label>Stop Loss %</label><input type="number" id="sl" value="0"></div>
            <div class="input-box"><label>RSI Limit (<)</label><input type="number" id="rsi" value="30"></div>
        </div>
        <div class="toggle" style="margin-top: 10px;">
            <span>üß† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RSI —Ñ–∏–ª—å—Ç—Ä</span>
            <input type="checkbox" id="rsi_on">
        </div>
    </div>

    <div class="card">
        <h3>üåä –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¢–µ–π–∫ (Trailing)</h3>
        <div class="toggle">
            <span>–í–∫–ª—é—á–∏—Ç—å Trailing Profit</span>
            <input type="checkbox" id="trail_on">
        </div>
        <div class="input-box">
            <label>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (Deviation %)</label>
            <input type="number" id="trail_dev" value="0.1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä 0.1">
        </div>
        <div style="font-size: 10px; color: var(--sub); margin-top: 5px;">
            –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ: –±–æ—Ç –Ω–µ –ø—Ä–æ–¥–∞—Å—Ç —Å—Ä–∞–∑—É, –∞ –±—É–¥–µ—Ç –∂–¥–∞—Ç—å —Ä–æ—Å—Ç–∞ —Ü–µ–Ω—ã, –ø–æ–∫–∞ –æ–Ω–∞ –Ω–µ –æ—Ç–∫–∞—Ç–∏—Ç—Å—è –Ω–∞–∑–∞–¥ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π %.
        </div>
    </div>

    <button class="btn-save" onclick="send('update')" style="width: 100%; margin-bottom: 10px;">
        üíæ –°–û–•–†–ê–ù–ò–¢–¨ –ò –ó–ê–ü–£–°–¢–ò–¢–¨
    </button>

    <div class="btn-row">
        <button class="btn-add" onclick="send('create_bot')">‚ûï –ù–æ–≤—ã–π –ë–æ—Ç</button>
        <button class="btn-stats" onclick="send('get_stats')">üìä –û—Ç—á–µ—Ç</button>
    </div>
    
    <div class="btn-row">
        <button class="btn-stop" onclick="send('stop')">üõë –°–¢–û–ü</button>
        <button class="btn-stop" onclick="send('sell_all')" style="border-color: #d29922; color: #d29922;">üö® –í–´–•–û–î</button>
    </div>

    <div class="footer">Saraf Robot V43 ‚Ä¢ Mobile Interface</div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        function send(action) {
            if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');

            const data = {
                action: action,
                // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –ø–æ–ª—è (–¥–∞–∂–µ –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –Ω–µ 'update', –ª–∏—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–º–µ—à–∞—é—Ç)
                symbol: document.getElementById('symbol').value.toUpperCase(),
                amount: parseFloat(document.getElementById('amount').value),
                mart: parseFloat(document.getElementById('mart').value),
                drop: parseFloat(document.getElementById('drop').value),
                tp: parseFloat(document.getElementById('tp').value),
                
                // –ù–æ–≤—ã–µ –ø–æ–ª—è
                range_min: parseFloat(document.getElementById('min_p').value),
                range_max: parseFloat(document.getElementById('max_p').value),
                stop_loss: parseFloat(document.getElementById('sl').value),
                rsi_limit: parseFloat(document.getElementById('rsi').value),
                rsi_enable: document.getElementById('rsi_on').checked,
                
                // Trailing
                trailing_enable: document.getElementById('trail_on').checked,
                trailing_dev: parseFloat(document.getElementById('trail_dev').value)
            };
            
            tg.sendData(JSON.stringify(data));
            if(action === 'update' || action === 'stop') tg.close();
        }
    </script>
</body>
</html>
