<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Saraf V44 Control</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #0d1117; 
            --card: #161b22; 
            --text: #e6edf3;
            --sub: #8b949e; 
            --green: #238636; 
            --red: #da3633; 
            --blue: #2f81f7; /* –ù–æ–≤—ã–π —è—Ä–∫–∏–π —Ü–≤–µ—Ç */
            --orange: #d29922;
        }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 16px; padding-bottom: 50px; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .badge { background: rgba(47, 129, 247, 0.2); color: var(--blue); padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; }
        
        /* –ö–ê–†–¢–û–ß–ö–ò */
        .card { background: var(--card); border: 1px solid #30363d; border-radius: 16px; padding: 16px; margin-bottom: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h3 { margin: 0 0 12px 0; font-size: 13px; color: var(--sub); text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #30363d; padding-bottom: 8px; }
        
        /* –°–ï–¢–ö–ê */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .input-box label { display: block; font-size: 11px; color: var(--sub); margin-bottom: 6px; }
        input { width: 100%; background: #0d1117; border: 1px solid #30363d; color: white; padding: 12px; border-radius: 8px; font-size: 14px; box-sizing: border-box; font-weight: 500; }
        input:focus { border-color: var(--blue); outline: none; box-shadow: 0 0 0 2px rgba(47, 129, 247, 0.3); }

        /* TOGGLES */
        .toggle { display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.03); padding: 10px; border-radius: 8px; margin-top: 8px; }
        .toggle span { font-size: 13px; font-weight: 500; }
        input[type="checkbox"] { width: 20px; height: 20px; accent-color: var(--blue); margin: 0; }

        /* –ö–ù–û–ü–ö–ò */
        .btn-row { display: flex; gap: 10px; margin-top: 12px; }
        button { flex: 1; padding: 14px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; color: white; font-size: 14px; transition: opacity 0.2s; }
        button:active { opacity: 0.8; transform: scale(0.98); }
        
        .btn-save { background: var(--green); width: 100%; margin-top: 10px; font-size: 16px; }
        .btn-stop { background: rgba(218, 54, 51, 0.1); border: 1px solid var(--red); color: var(--red); }
        .btn-add { background: var(--blue); }
        .btn-stats { background: #30363d; color: var(--text); border: 1px solid #8b949e; }

        .hint { font-size: 10px; color: var(--sub); margin-top: 6px; line-height: 1.4; }
    </style>
</head>
<body>

    <div class="header">
        <div>
            <div style="font-size: 20px; font-weight: 800;">SARAF V44</div>
            <div style="font-size: 12px; color: var(--sub);">Full Control Panel</div>
        </div>
        <div class="badge">UPDATED</div>
    </div>

    <div class="card">
        <h3>‚ö° –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –í—Ö–æ–¥–∞</h3>
        <div class="input-box" style="margin-bottom: 12px;">
            <label>–¢–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞ (SYMBOL)</label>
            <input type="text" id="symbol" value="ETH/USDC" style="color: var(--blue); font-weight: bold; font-size: 16px;">
        </div>
        <div class="grid">
            <div class="input-box"><label>–õ–æ—Ç ($)</label><input type="number" id="amount" value="10"></div>
            <div class="input-box"><label>Martingale (x)</label><input type="number" id="mart" value="1.5"></div>
            <div class="input-box"><label>Drop %</label><input type="number" id="drop" value="0.35"></div>
            <div class="input-box"><label>Take Profit %</label><input type="number" id="tp" value="0.5"></div>
        </div>
    </div>

    <div class="card">
        <h3>üìè –î–∏–∞–ø–∞–∑–æ–Ω —Ç–æ—Ä–≥–æ–≤</h3>
        <div class="grid">
            <div class="input-box"><label>Min –¶–µ–Ω–∞ (0=–í—ã–∫–ª)</label><input type="number" id="min_p" value="0"></div>
            <div class="input-box"><label>Max –¶–µ–Ω–∞ (0=–í—ã–∫–ª)</label><input type="number" id="max_p" value="0"></div>
        </div>
        <div class="hint">–ë–æ—Ç –Ω–µ –±—É–¥–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å, –µ—Å–ª–∏ —Ü–µ–Ω–∞ –≤—ã–π–¥–µ—Ç –∑–∞ —ç—Ç–∏ –ø—Ä–µ–¥–µ–ª—ã.</div>
    </div>

    <div class="card">
        <h3>üåä Trailing Profit</h3>
        <div class="toggle">
            <span>–í–∫–ª—é—á–∏—Ç—å Trailing</span>
            <input type="checkbox" id="trail_on">
        </div>
        <div class="input-box" style="margin-top: 8px;">
            <label>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (Deviation %)</label>
            <input type="number" id="trail_dev" value="0.1" placeholder="0.1">
        </div>
        <div class="hint">
            –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –±–æ—Ç –±—É–¥–µ—Ç "—Ç—è–Ω—É—Ç—å" –ø—Ä–∏–±—ã–ª—å –≤–≤–µ—Ä—Ö –∏ –ø—Ä–æ–¥–∞—Å—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–∫–∞—Ç–µ —Ü–µ–Ω—ã –Ω–∞–∑–∞–¥.
        </div>
    </div>

    <div class="card">
        <h3>üõ°Ô∏è –†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</h3>
        <div class="grid">
            <div class="input-box"><label>Stop Loss %</label><input type="number" id="sl" value="0"></div>
            <div class="input-box"><label>RSI Limit (<)</label><input type="number" id="rsi" value="30"></div>
        </div>
        <div class="toggle">
            <span>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RSI —Ñ–∏–ª—å—Ç—Ä</span>
            <input type="checkbox" id="rsi_on">
        </div>
    </div>

    <button class="btn-save" onclick="send('update')">
        üíæ –°–û–•–†–ê–ù–ò–¢–¨ –ò –ó–ê–ü–£–°–¢–ò–¢–¨
    </button>

    <div class="btn-row">
        <button class="btn-add" onclick="send('create_bot')">‚ûï –ù–æ–≤—ã–π –ë–æ—Ç</button>
        <button class="btn-stats" onclick="send('get_stats')">üìä –û—Ç—á–µ—Ç</button>
    </div>
    
    <div class="btn-row">
        <button class="btn-stop" onclick="send('stop')">üõë –°–¢–û–ü</button>
        <button class="btn-stop" onclick="send('sell_all')" style="border-color: #d29922; color: #d29922;">üö® –ü–†–û–î–ê–¢–¨ –í–°–Å</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // –ê–Ω–∏–º–∞—Ü–∏—è –≤–∏–±—Ä–∞—Ü–∏–∏
        function haptic() {
            if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
        }

        function send(action) {
            haptic();

            const data = {
                action: action,
                symbol: document.getElementById('symbol').value.toUpperCase(),
                amount: parseFloat(document.getElementById('amount').value),
                mart: parseFloat(document.getElementById('mart').value),
                drop: parseFloat(document.getElementById('drop').value),
                tp: parseFloat(document.getElementById('tp').value),
                
                // –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
                range_min: parseFloat(document.getElementById('min_p').value),
                range_max: parseFloat(document.getElementById('max_p').value),
                stop_loss: parseFloat(document.getElementById('sl').value),
                rsi_limit: parseFloat(document.getElementById('rsi').value),
                rsi_enable: document.getElementById('rsi_on').checked,
                
                trailing_enable: document.getElementById('trail_on').checked,
                trailing_dev: parseFloat(document.getElementById('trail_dev').value)
            };
            
            tg.sendData(JSON.stringify(data));
            if(action === 'update' || action === 'stop') tg.close();
        }
    </script>
</body>
</html>